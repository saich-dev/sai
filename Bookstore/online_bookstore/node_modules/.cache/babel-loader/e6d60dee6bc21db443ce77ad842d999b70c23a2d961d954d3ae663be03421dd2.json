{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\saiku\\\\OneDrive\\\\Desktop\\\\odin\\\\Bookstore\\\\online_bookstore\\\\src\\\\components\\\\events\\\\events\\\\Events.jsx\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router';\nimport axios from 'axios';\nimport moment from 'moment';\nimport toastr from 'toastr';\nimport EventsComponent from './EventsComponents';\nimport Search from './../../common/Search';\nimport PageNotFound from './../../common/PageNotFound';\nimport LoadIndicator from './../../common/LoadIndicator';\nimport './Events.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass Events extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      events: [],\n      query: '',\n      buttonPart: true\n    };\n  }\n  componentDidMount() {\n    axios.get('/api/event').then(res => {\n      this.setState({\n        events: res.data\n      });\n    }).catch(error => {\n      if (error.response.status === 401) {\n        this.props.history.push(\"/\");\n      }\n    });\n  }\n  handleSearch(event) {\n    this.setState({\n      query: event.target.value\n    });\n  }\n  eventAction(eventId, title) {\n    axios.defaults.headers.common['Authorization'] = localStorage.getItem('jwtToken');\n    const name = localStorage.getItem('name');\n    const currentEvent = this.state.events.find(e => e._id === eventId);\n    const index = currentEvent.users.findIndex(u => u === name);\n    if (index > -1) {\n      axios.put('/api/auth/leave', {\n        eventId,\n        name\n      }).then(result => {\n        // this.props.history.go(0);\n        this.props.history.push(\"/event/\" + eventId);\n        toastr.success('You leave the event.');\n      }).catch(error => {\n        if (error.response.status === 401) {\n          this.props.history.push(\"/login\");\n        }\n      });\n    } else {\n      axios.put('/api/auth/participate', {\n        eventId,\n        title,\n        name\n      }).then(result => {\n        // this.props.history.go(0);\n        this.props.history.push(\"/event/\" + eventId);\n        toastr.success('You take part in this event.');\n      }).catch(error => {\n        if (error.response.status === 401) {\n          this.props.history.push(\"/login\");\n        }\n      });\n    }\n  }\n  render() {\n    moment.locale('en');\n    const EventsWithLoadIndicator = LoadIndicator('events')(EventsComponent);\n    let view;\n    let filteredItems = this.state.events.filter(e => e.title.toLowerCase().indexOf(this.state.query.toLowerCase()) !== -1);\n    if (filteredItems.length <= 0 && this.state.query) {\n      view = /*#__PURE__*/_jsxDEV(PageNotFound, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 16\n      }, this);\n    } else {\n      view = /*#__PURE__*/_jsxDEV(EventsWithLoadIndicator, {\n        events: filteredItems,\n        eventAction: this.eventAction.bind(this),\n        buttonPart: this.state.buttonPart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 16\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4\",\n          children: /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"event-title\",\n            children: \"Events\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4 offset-md-4\",\n          children: /*#__PURE__*/_jsxDEV(Search, {\n            search: this.handleSearch.bind(this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"py-5\",\n        children: view\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this);\n  }\n}\nexport default _c = withRouter(Events);\nvar _c;\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"names":["React","Component","withRouter","axios","moment","toastr","EventsComponent","Search","PageNotFound","LoadIndicator","jsxDEV","_jsxDEV","Events","constructor","props","state","events","query","buttonPart","componentDidMount","get","then","res","setState","data","catch","error","response","status","history","push","handleSearch","event","target","value","eventAction","eventId","title","defaults","headers","common","localStorage","getItem","name","currentEvent","find","e","_id","index","users","findIndex","u","put","result","success","render","locale","EventsWithLoadIndicator","view","filteredItems","filter","toLowerCase","indexOf","length","fileName","_jsxFileName","lineNumber","columnNumber","bind","className","children","search","_c","$RefreshReg$"],"sources":["C:/Users/saiku/OneDrive/Desktop/odin/Bookstore/online_bookstore/src/components/events/events/Events.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { withRouter } from 'react-router'\nimport axios from 'axios';\nimport moment from 'moment';\nimport toastr from 'toastr';\nimport EventsComponent from './EventsComponents';\nimport Search from './../../common/Search';\nimport PageNotFound from './../../common/PageNotFound';\nimport LoadIndicator from './../../common/LoadIndicator';\nimport './Events.css';\n\nclass Events extends Component {\n    constructor(props){\n        super(props);\n        this.state= {\n            events: [],\n            query: '',\n            buttonPart: true,\n        }; \n    }\n\n    componentDidMount() {\n        axios.get('/api/event')\n        .then(res => {\n            this.setState({ events: res.data });\n        })\n          .catch((error) => {\n            if(error.response.status === 401) {\n              this.props.history.push(\"/\");\n            }\n          });\n          \n    }\n\n    handleSearch(event){\n\t\tthis.setState({query: event.target.value});\n    }\n    \n    eventAction(eventId, title){\n        axios.defaults.headers.common['Authorization'] = localStorage.getItem('jwtToken');\n        const name = localStorage.getItem('name');\n        const currentEvent = this.state.events.find(e => e._id === eventId);\n        const index = currentEvent.users.findIndex(u => u  ===  name);\n               if(index > -1){\n                axios.put('/api/auth/leave', {eventId, name})\n                .then((result) => {\n                    // this.props.history.go(0);\n                    this.props.history.push(\"/event/\" + eventId);\n                    toastr.success('You leave the event.');\n                })\n                .catch((error) => {\n                       if(error.response.status === 401) {\n                       this.props.history.push(\"/login\");\n                      }\n                });\n               } else {\n                axios.put('/api/auth/participate', {eventId, title, name})\n                .then((result) => {\n                // this.props.history.go(0);\n                this.props.history.push(\"/event/\" + eventId);\n                toastr.success('You take part in this event.');\n                })\n                .catch((error) => {\n                    if(error.response.status === 401) {\n                       this.props.history.push(\"/login\");\n                      }\n                });\n               }\n      }\n\n    render(){\n        moment.locale('en');\n        const EventsWithLoadIndicator = LoadIndicator('events')(EventsComponent);       \n        \n        let view;\n        let filteredItems = this.state.events.filter(e => e.title.toLowerCase().indexOf(this.state.query.toLowerCase()) !== -1);\n        \n        if(filteredItems.length <= 0 && this.state.query){\n        view = <PageNotFound />\n        } else {\n        view = <EventsWithLoadIndicator events={filteredItems} eventAction={this.eventAction.bind(this)} buttonPart={this.state.buttonPart} />  \n            }\n\n        return(\n            <div className=\"container\">\n                <div className=\"row\">\n                    <div className=\"col-md-4\">\n                    <h2 className=\"event-title\">Events</h2>\n                    </div>\n                    <div className=\"col-md-4 offset-md-4\">\n                    <Search search={this.handleSearch.bind(this)} />\n                    </div>\n                </div>\n                <div className=\"py-5\">\n                {view}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Events);\n                              \n\n\n        \n      \n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}